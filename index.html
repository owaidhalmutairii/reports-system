<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠØ© - ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØµØ­Ø©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e5a3e 0%, #2d7a54 100%);
            min-height: 100vh;
            padding: 15px;
        }
        
        .container {
            max-width: 950px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .main-title {
            font-size: 26px;
            font-weight: bold;
            color: #1e5a3e;
            margin-bottom: 8px;
        }

        .sub-title {
            font-size: 16px;
            color: #2d7a54;
            font-weight: 600;
            margin: 5px 0;
        }

        .dept-title {
            font-size: 14px;
            color: #666;
            margin: 3px 0;
        }
        
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .tab {
            flex: 1;
            min-width: 150px;
            padding: 12px;
            background: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: #1e5a3e;
            color: white;
        }
        
        .content-area {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: none;
        }
        
        .content-area.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            font-weight: bold;
            color: #1e5a3e;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .form-input, .form-textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
        }

        .form-input:disabled {
            background: #f0f0f0;
            cursor: not-allowed;
        }
        
        .form-textarea {
            min-height: 60px;
            resize: vertical;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .location-selector {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            justify-content: center;
        }

        .location-btn {
            flex: 1;
            padding: 15px;
            border: 3px solid #1e5a3e;
            background: white;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            color: #1e5a3e;
            cursor: pointer;
            transition: all 0.3s;
        }

        .location-btn.active {
            background: #1e5a3e;
            color: white;
        }
        
        .item-box {
            border: 2px solid #1e5a3e;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background: #f9fdf9;
        }
        
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .item-num {
            background: #1e5a3e;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .item-title {
            flex: 1;
            font-weight: 600;
            color: #1e5a3e;
            font-size: 14px;
        }
        
        .checkbox-group {
            display: flex;
            gap: 15px;
        }
        
        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .checkbox-label input {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #1e5a3e;
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn:hover {
            opacity: 0.9;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .report-card {
            background: #f9fdf9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-right: 4px solid #1e5a3e;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .report-card:hover {
            transform: translateX(-5px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .report-title {
            font-size: 16px;
            font-weight: bold;
            color: #1e5a3e;
            margin-bottom: 5px;
        }
        
        .report-info {
            font-size: 13px;
            color: #666;
            margin-top: 5px;
        }

        .location-badge {
            display: inline-block;
            padding: 4px 10px;
            background: #e8f5e9;
            color: #1e5a3e;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-top: 5px;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: bold;
            margin-top: 8px;
        }

        .status-open {
            background: #fff3cd;
            color: #856404;
        }

        .status-closed {
            background: #d4edda;
            color: #155724;
        }

        .status-expired {
            background: #f8d7da;
            color: #721c24;
        }

        .wo-action-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
        }

        .wo-btn-create {
            background: #1e5a3e;
            color: white;
        }

        .wo-btn-close {
            background: #28a745;
            color: white;
        }

        .wo-action-btn:hover {
            opacity: 0.9;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .success-msg {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
        }

        .section-title {
            color: #1e5a3e;
            font-size: 18px;
            font-weight: bold;
            margin: 20px 0 15px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid #e8f5e9;
        }

        .images-section {
            margin-top: 15px;
            padding: 12px;
            background: white;
            border-radius: 8px;
        }

        .image-upload {
            margin-bottom: 10px;
        }

        .file-upload {
            border: 2px dashed #1e5a3e;
            border-radius: 6px;
            padding: 8px;
            font-size: 13px;
            width: 100%;
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: white;
            font-size: 12px;
            margin-top: 20px;
        }

        small {
            display: block;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="main-title">ğŸ“‹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</div>
            <div class="sub-title">ÙØ±Ø¹ ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØµØ­Ø© Ø¨Ø­ÙØ± Ø§Ù„Ø¨Ø§Ø·Ù†</div>
            <div class="dept-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø³Ø§Ù†Ø¯Ø© - Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…Ø³Ø§Ù†Ø¯</div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showPage('new')">ğŸ“ ØªÙ‚Ø±ÙŠØ± Ø¬Ø¯ÙŠØ¯</button>
            <button class="tab" onclick="showPage('list')">ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
            <button class="tab" onclick="showPage('workorders')">ğŸ”§ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¹Ù…Ù„</button>
            <button class="tab" onclick="showPage('settings')">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
        </div>
        
        <!-- ØªÙ‚Ø±ÙŠØ± Ø¬Ø¯ÙŠØ¯ -->
        <div class="content-area active" id="page-new">
            <h3 class="section-title">ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ Ø¬Ø¯ÙŠØ¯</h3>
            
            <div id="successMsg" class="success-msg" style="display: none;">
                âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­!
            </div>

            <form id="reportForm" onsubmit="saveReport(event)">
                <div class="form-group">
                    <label class="form-label">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" class="form-input" id="date" disabled>
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ù‚Ø§Ø¦Ù…ÙˆÙ† Ø¨Ø§Ù„Ø¬ÙˆÙ„Ø© *</label>
                    <div class="form-grid">
                        <input type="text" class="form-input" id="person1" placeholder="Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø£ÙˆÙ„" required>
                        <input type="text" class="form-input" id="person2" placeholder="Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø«Ø§Ù†ÙŠ" required>
                        <input type="text" class="form-input" id="person3" placeholder="Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø«Ø§Ù„Ø«" required>
                    </div>
                </div>

                <div class="location-selector">
                    <button type="button" class="location-btn active" onclick="selectLocation('inside', event)">
                        ğŸ¢ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¨Ù†Ù‰
                    </button>
                    <button type="button" class="location-btn" onclick="selectLocation('outside', event)">
                        ğŸŒ³ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø¨Ù†Ù‰
                    </button>
                </div>

                <input type="hidden" id="selectedLocation" value="inside">
                
                <h4 class="section-title">Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</h4>
                
                <div id="itemsContainer"></div>
                
                <div class="button-group">
                    <button type="submit" class="btn btn-primary">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
                    <button type="button" class="btn btn-secondary" onclick="resetForm()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø©</button>
                </div>
            </form>
        </div>
        
        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± -->
        <div class="content-area" id="page-list">
            <h3 class="section-title">ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</h3>
            <div id="reportsList"></div>
        </div>
        
        <!-- Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¹Ù…Ù„ -->
        <div class="content-area" id="page-workorders">
            <h3 class="section-title">ğŸ”§ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¹Ù…Ù„</h3>
            <div id="workOrdersList"></div>
        </div>

        <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
        <div class="content-area" id="page-settings">
            <h3 class="section-title">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
            
            <div class="form-group">
                <label class="form-label">Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…ÙŠÙ† Ø¨Ø§Ù„Ø¬ÙˆÙ„Ø© (Ø§ÙØªØ±Ø§Ø¶ÙŠ)</label>
                <div class="form-grid">
                    <input type="text" class="form-input" id="defaultPerson1" placeholder="Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø£ÙˆÙ„">
                    <input type="text" class="form-input" id="defaultPerson2" placeholder="Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø«Ø§Ù†ÙŠ">
                    <input type="text" class="form-input" id="defaultPerson3" placeholder="Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø«Ø§Ù„Ø«">
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙˆÙ„ *</label>
                <input type="email" class="form-input" id="contractorEmail" placeholder="contractor@company.com">
                <small style="color:#666;font-size:12px;">Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¹Ù…Ù„ Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</small>
            </div>

            <div class="form-group">
                <label class="form-label">Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø¥ØºÙ„Ø§Ù‚ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¹Ù…Ù„ *</label>
                <input type="email" class="form-input" id="supervisorEmail" placeholder="supervisor@moh.gov.sa">
                <small style="color:#666;font-size:12px;">ÙÙ‚Ø· Ù‡Ø°Ø§ Ø§Ù„Ø´Ø®Øµ ÙŠÙ…ÙƒÙ†Ù‡ Ø¥ØºÙ„Ø§Ù‚ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¹Ù…Ù„</small>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="saveSettings()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
            </div>
        </div>
    </div>

    <div class="footer">
        <p style="margin-bottom: 5px;">ØªØ·ÙˆÙŠØ± ÙˆØªØµÙ…ÙŠÙ…: Ø¹ÙˆÙŠØ¶ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ</p>
        <p style="font-size: 11px; opacity: 0.8;">Â© 2025 Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
    </div>

    <script>
        const itemsInside = [
            'Ù†Ø¸Ø§ÙØ© Ù…Ù…Ø±Ø§Øª Ø§Ù„Ù…Ø¨Ù†Ù‰',
            'Ù†Ø¸Ø§ÙØ© Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ù…ÙŠØ§Ù‡',
            'Ù†Ø¸Ø§ÙØ© Ø§Ù„Ù…ÙƒØ§ØªØ¨ ÙˆØ§Ù„ØºØ±Ù',
            'ØªÙˆÙØ± Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØµØ­ÙŠØ© (ØµØ§Ø¨ÙˆÙ† - Ù…Ù†Ø´ÙØ§Øª - Ø§Ù„Ø®)',
            'Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø£Ø«Ø§Ø« ÙˆØ§Ù„Ù…ÙƒØ§ØªØ¨',
            'Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ù…Ø¨Ù†Ù‰ ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯',
            'Ø§Ù„ØªÙƒÙŠÙŠÙ ÙŠØ¹Ù…Ù„ Ø¨ÙƒÙØ§Ø¡Ø©',
            'Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ† Ø¨Ø§Ù„Ø²ÙŠ Ø§Ù„Ø±Ø³Ù…ÙŠ',
            'Ù…Ø®Ø§Ø±Ø¬ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯',
            'Ù„ÙˆØ­Ø§Øª Ø¥Ø±Ø´Ø§Ø¯ÙŠØ© ÙˆØ§Ø¶Ø­Ø©',
            'Ù†Ø¸Ø§ÙØ© Ø§Ù„Ù…ØµØ§Ø¹Ø¯',
            'ØµÙŠØ§Ù†Ø© Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨ ÙˆØ§Ù„Ù†ÙˆØ§ÙØ°'
        ];

        const itemsOutside = [
            'Ù†Ø¸Ø§ÙØ© Ø§Ù„Ù…Ø¯Ø§Ø®Ù„ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©',
            'Ù†Ø¸Ø§ÙØ© Ù…ÙˆØ§Ù‚Ù Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª',
            'Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø­Ø¯Ø§Ø¦Ù‚ ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø§Øª Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡',
            'Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ù Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©',
            'ÙˆØ¶ÙˆØ­ Ø§Ù„Ù„ÙˆØ­Ø§Øª Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯ÙŠØ© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©',
            'Ù†Ø¸Ø§ÙØ© Ø§Ù„Ù…Ù…Ø±Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©',
            'ØµÙŠØ§Ù†Ø© Ø§Ù„Ø£Ø±ØµÙØ©',
            'Ù†Ø¸Ø§ÙØ© ØµÙ†Ø§Ø¯ÙŠÙ‚ Ø§Ù„Ù‚Ù…Ø§Ù…Ø© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©',
            'Ø­Ø§Ù„Ø© Ø§Ù„Ø³ÙˆØ± Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ',
            'Ø§Ù„Ø¨ÙˆØ§Ø¨Ø§Øª ÙˆØ§Ù„Ù…Ø¯Ø§Ø®Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©'
        ];

        window.onload = function() {
            setTodayDate();
            loadSettings();
            createItems('inside');
            setupCheckboxes();
        };

        function selectLocation(location, event) {
            event.preventDefault();
            document.querySelectorAll('.location-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('selectedLocation').value = location;
            createItems(location);
            setupCheckboxes();
        }

        function createItems(location) {
            const container = document.getElementById('itemsContainer');
            const items = location === 'inside' ? itemsInside : itemsOutside;
            let html = '';
            
            items.forEach((item, i) => {
                const num = i + 1;
                html += `
                    <div class="item-box">
                        <div class="item-header">
                            <div class="item-num">${num}</div>
                            <div class="item-title">${item}</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="item${num}" value="yes"> Ù†Ø¹Ù…
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="item${num}" value="no"> Ù„Ø§
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</label>
                            <textarea class="form-textarea" id="notes${num}"></textarea>
                        </div>
                        <div class="images-section">
                            <label class="form-label">ğŸ“¸ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±ÙÙ‚Ø© (Ø­ØªÙ‰ 3 ØµÙˆØ±):</label>
                            <div class="image-upload">
                                <input type="file" accept="image/*" id="img${num}_1" class="file-upload">
                            </div>
                            <div class="image-upload">
                                <input type="file" accept="image/*" id="img${num}_2" class="file-upload">
                            </div>
                            <div class="image-upload">
                                <input type="file" accept="image/*" id="img${num}_3" class="file-upload">
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function setupCheckboxes() {
            setTimeout(() => {
                const location = document.getElementById('selectedLocation').value;
                const itemsCount = location === 'inside' ? itemsInside.length : itemsOutside.length;
                
                for (let i = 1; i <= itemsCount; i++) {
                    const boxes = document.querySelectorAll(`input[name="item${i}"]`);
                    boxes.forEach(box => {
                        box.addEventListener('change', function() {
                            if (this.checked) {
                                boxes.forEach(b => {
                                    if (b !== this) b.checked = false;
                                });
                            }
                        });
                    });
                }
            }, 100);
        }

        function showPage(page) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.content-area').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById('page-' + page).classList.add('active');
            
            if (page === 'list') loadReports();
            if (page === 'workorders') loadWorkOrders();
        }

        function saveReport(e) {
            e.preventDefault();
                      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† ÙƒÙ„ Ø§Ù„Ø¨Ù†ÙˆØ¯ ØªÙ… Ø§Ø®ØªÙŠØ§Ø±Ù‡Ø§
                     const location = document.getElementById('selectedLocation').value;
                     const items = location === 'inside' ? itemsInside : itemsOutside;

                      for (let i = 1; i <= items.length; i++) {
                           const checked = document.querySelector(input[name="item${i}"]:checked);
                           if (!checked) {
                               alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù†ÙˆØ¯! \nØ§Ù„Ø¨Ù†Ø¯ Ø±Ù‚Ù… ' + i + ' Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø±Ù‡.');
                               return;
                           }

            const location = document.getElementById('selectedLocation').value;
            const items = location === 'inside' ? itemsInside : itemsOutside;
            const reportItems = [];

            for (let i = 1; i <= items.length; i++) {
                const checked = document.querySelector(`input[name="item${i}"]:checked`);
                
                const item = {
                    number: i,
                    title: items[i-1],
                    result: checked ? (checked.value === 'yes' ? 'âœ“ Ù†Ø¹Ù…' : 'âœ— Ù„Ø§') : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    notes: document.getElementById('notes' + i).value,
                    images: []
                };
                
                for (let j = 1; j <= 3; j++) {
                    const imgInput = document.getElementById('img' + i + '_' + j);
                    if (imgInput && imgInput.files[0]) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            item.images.push(event.target.result);
                        };
                        reader.readAsDataURL(imgInput.files[0]);
                    }
                }
                
                reportItems.push(item);
            }

            const report = {
                id: Date.now(),
                date: document.getElementById('date').value,
                person1: document.getElementById('person1').value,
                person2: document.getElementById('person2').value,
                person3: document.getElementById('person3').value,
                location: location,
                locationText: location === 'inside' ? 'Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¨Ù†Ù‰' : 'Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø¨Ù†Ù‰',
                items: reportItems,
                createdAt: new Date().toISOString()
            };

            setTimeout(() => {
                let reports = JSON.parse(localStorage.getItem('moh_reports') || '[]');
                reports.unshift(report);
                localStorage.setItem('moh_reports', JSON.stringify(reports));

                document.getElementById('successMsg').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('successMsg').style.display = 'none';
                    resetForm();
                    showPageDirect('list');
                }, 2000);
            }, 500);
        }

        function showPageDirect(page) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.content-area').forEach(c => c.classList.remove('active'));
            
            const tabs = document.querySelectorAll('.tab');
            const pages = ['new', 'list', 'workorders', 'settings'];
            const index = pages.indexOf(page);
            if (index >= 0 && tabs[index]) {
                tabs[index].classList.add('active');
            }
            
            document.getElementById('page-' + page).classList.add('active');
            
            if (page === 'list') loadReports();
            if (page === 'workorders') loadWorkOrders();
        }

        function resetForm() {
            document.getElementById('reportForm').reset();
            setTodayDate();
            loadSettings();
            selectLocationDirect('inside');
        }

        function selectLocationDirect(location) {
            document.querySelectorAll('.location-btn').forEach(btn => btn.classList.remove('active'));
            const btns = document.querySelectorAll('.location-btn');
            if (location === 'inside' && btns[0]) {
                btns[0].classList.add('active');
            } else if (location === 'outside' && btns[1]) {
                btns[1].classList.add('active');
            }
            document.getElementById('selectedLocation').value = location;
            createItems(location);
            setupCheckboxes();
        }

        function loadReports() {
            const list = document.getElementById('reportsList');
            const reports = JSON.parse(localStorage.getItem('moh_reports') || '[]');

            if (reports.length === 0) {
                list.innerHTML = '<div class="empty-state"><div style="font-size:40px;margin-bottom:10px;">ğŸ“‹</div><p>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ±</p></div>';
                return;
            }

            let html = '';

            reports.forEach((r, i) => {
                html += `
                    <div class="report-card" onclick="viewReport(${i})">
                        <div class="report-title">ğŸ“„ ØªÙ‚Ø±ÙŠØ± ${r.date}</div>
                        <div class="report-info">
                            ğŸ‘¥ ${r.person1}, ${r.person2}, ${r.person3}
                        </div>
                        <div class="location-badge">${r.locationText}</div>
                    </div>
                `;
            });

            list.innerHTML = html;
        }

        function viewReport(index) {
            const reports = JSON.parse(localStorage.getItem('moh_reports') || '[]');
            const r = reports[index];
            
            let html = `
                <h3 class="section-title">ğŸ“„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</h3>
                <div style="background:#f9fdf9;padding:15px;border-radius:8px;margin-bottom:15px;">
                    <p><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${r.date}</p>
                    <p><strong>Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong> ${r.locationText}</p>
                    <p><strong>Ø§Ù„Ù‚Ø§Ø¦Ù…ÙˆÙ† Ø¨Ø§Ù„Ø¬ÙˆÙ„Ø©:</strong></p>
                    <p>1. ${r.person1}</p>
                    <p>2. ${r.person2}</p>
                    <p>3. ${r.person3}</p>
                </div>
                <h4 class="section-title">Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h4>
            `;

            r.items.forEach(item => {
                const color = item.result.includes('Ù†Ø¹Ù…') ? '#155724' : item.result.includes('Ù„Ø§') ? '#721c24' : '#666';
                const showWorkOrderBtn = item.result.includes('Ù„Ø§');
                
                html += `
                    <div class="item-box">
                        <div class="item-header">
                            <div class="item-num">${item.number}</div>
                            <div class="item-title">${item.title}</div>
                            <div style="font-weight:bold;color:${color};font-size:14px;">${item.result}</div>
                        </div>
                        ${item.notes ? '<div style="background:white;padding:10px;border-radius:6px;margin-top:8px;"><strong>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</strong> ' + item.notes + '</div>' : ''}
                        ${item.images && item.images.length > 0 ? '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px;margin-top:10px;">' + item.images.map(img => '<img src="' + img + '" style="width:100%;border-radius:8px;border:2px solid #1e5a3e;">').join('') + '</div>' : ''}
                        ${showWorkOrderBtn ? '<div style="margin-top:10px;"><button class="wo-action-btn wo-btn-create" onclick="createWorkOrder(' + index + ', ' + item.number + ')">ğŸ”§ Ø¥Ù†Ø´Ø§Ø¡ Ø£Ù…Ø± Ø¹Ù…Ù„</button></div>' : ''}
                    </div>
                `;
            });

            html += `
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="loadReports()">â†©ï¸ Ø±Ø¬ÙˆØ¹</button>
                    <button class="btn btn-primary" onclick="printReport(${index})">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
                </div>
            `;

            document.getElementById('reportsList').innerHTML = html;
        }

        function createWorkOrder(reportIndex, itemNumber) {
            const reports = JSON.parse(localStorage.getItem('moh_reports') || '[]');
            const report = reports[reportIndex];
            const item = report.items.find(i => i.number === itemNumber);
            
            const contractorEmail = localStorage.getItem('moh_contractorEmail');
            if (!contractorEmail) {
                alert('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙˆÙ„ ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£ÙˆÙ„Ø§Ù‹');
                showPageDirect('settings');
                return;
            }

            const workOrder = {
                id: Date.now(),
                reportId: report.id,
                reportDate: report.date,
                itemNumber: itemNumber,
                itemTitle: item.title,
                location: report.locationText,
                notes: item.notes,
                images: item.images || [],
                createdAt: new Date().toISOString(),
                deadline: new Date(Date.now() + 72 * 60 * 60 * 1000).toISOString(),
                status: 'open',
                createdBy: report.person1
            };

            let workOrders = JSON.parse(localStorage.getItem('moh_workorders') || '[]');
            workOrders.unshift(workOrder);
            localStorage.setItem('moh_workorders', JSON.stringify(workOrders));

            const deadlineDate = new Date(workOrder.deadline);
            const deadlineFormatted = deadlineDate.toLocaleString('ar-SA', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });

            const emailSubject = 'Ø£Ù…Ø± Ø¹Ù…Ù„ Ø¬Ø¯ÙŠØ¯ Ø±Ù‚Ù… ' + workOrder.id + ' - ' + item.title;
            const emailBody = 'Ø£Ù…Ø± Ø¹Ù…Ù„ Ø±Ù‚Ù…: ' + workOrder.id + '\n\nğŸ“‹ Ø§Ù„ØªÙØ§ØµÙŠÙ„:\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: ' + report.date + '\nğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ' + report.locationText + '\nğŸ”§ Ø§Ù„Ø¨Ù†Ø¯: ' + item.title + '\nğŸ“ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ' + (item.notes || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª') + '\n\nâ° Ù…Ø¯Ø© Ø§Ù„ØªÙ†ÙÙŠØ°: 72 Ø³Ø§Ø¹Ø©\nğŸ“† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡: ' + deadlineFormatted + '\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nâš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯\n\nÙ…Ø¹ ØªØ­ÙŠØ§ØªØŒ\nÙØ±Ø¹ ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØµØ­Ø© Ø¨Ø­ÙØ± Ø§Ù„Ø¨Ø§Ø·Ù†\nØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø³Ø§Ù†Ø¯Ø© - Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…Ø³Ø§Ù†Ø¯';

            const mailtoLink = 'mailto:' + contractorEmail + '?subject=' + encodeURIComponent(emailSubject) + '&body=' + encodeURIComponent(emailBody);
            window.open(mailtoLink, '_blank');

            alert('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø£Ù…Ø± Ø§Ù„Ø¹Ù…Ù„ ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡ Ù„Ù„Ù…Ù‚Ø§ÙˆÙ„');
            showPageDirect('workorders');
        }

        function loadWorkOrders() {
            const list = document.getElementById('workOrdersList');
            const workOrders = JSON.parse(localStorage.getItem('moh_workorders') || '[]');

            if (workOrders.length === 0) {
                list.innerHTML = '<div class="empty-state"><div style="font-size:40px;margin-bottom:10px;">ğŸ”§</div><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙˆØ§Ù…Ø± Ø¹Ù…Ù„</p></div>';
                return;
            }

            let html = '';
            const now = new Date();

            workOrders.forEach((wo, i) => {
                const deadline = new Date(wo.deadline);
                const isExpired = now > deadline && wo.status === 'open';
                const hoursLeft = Math.max(0, Math.round((deadline - now) / (1000 * 60 * 60)));
                
                let statusBadge = '';
                if (wo.status === 'closed') {
                    statusBadge = '<span class="status-badge status-closed">âœ“ Ù…ØºÙ„Ù‚</span>';
                } else if (isExpired) {
                    statusBadge = '<span class="status-badge status-expired">âš ï¸ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„Ù…Ø¯Ø©</span>';
                } else {
                    statusBadge = '<span class="status-badge status-open">â±ï¸ Ù…ÙØªÙˆØ­ - Ù…ØªØ¨Ù‚ÙŠ ' + hoursLeft + ' Ø³Ø§Ø¹Ø©</span>';
                }

                html += '<div class="report-card" onclick="viewWorkOrder(' + i + ')"><div class="report-title">ğŸ”§ Ø£Ù…Ø± Ø¹Ù…Ù„ #' + wo.id + '</div><div class="report-info">ğŸ“ ' + wo.itemTitle + '<br>ğŸ“… ' + wo.reportDate + ' | ' + wo.location + '<br>ğŸ‘¤ ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØ§Ø³Ø·Ø©: ' + wo.createdBy + '</div>' + statusBadge;
                
                if (wo.closedBy) {
                    html += '<div style="margin-top:8px;font-size:12px;color:#155724;">âœ“ ØªÙ… Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø¨ÙˆØ§Ø³Ø·Ø©: ' + wo.closedBy + '</div>';
                }
                
                html += '</div>';
            });

            list.innerHTML = html;
        }

        function viewWorkOrder(index) {
            const workOrders = JSON.parse(localStorage.getItem('moh_workorders') || '[]');
            const wo = workOrders[index];
            const supervisorEmail = localStorage.getItem('moh_supervisorEmail') || '';
            
            const deadline = new Date(wo.deadline);
            const now = new Date();
            const isExpired = now > deadline && wo.status === 'open';
            const hoursLeft = Math.max(0, Math.round((deadline - now) / (1000 * 60 * 60)));

            let html = '<h3 class="section-title">ğŸ”§ ØªÙØ§ØµÙŠÙ„ Ø£Ù…Ø± Ø§Ù„Ø¹Ù…Ù„ #' + wo.id + '</h3><div style="background:#f9fdf9;padding:15px;border-radius:8px;margin-bottom:15px;"><p><strong>ğŸ“ Ø§Ù„Ø¨Ù†Ø¯:</strong> ' + wo.itemTitle + '</p><p><strong>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ' + wo.reportDate + '</p><p><strong>ğŸ¢ Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong> ' + wo.location + '</p><p><strong>ğŸ‘¤ ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØ§Ø³Ø·Ø©:</strong> ' + wo.createdBy + '</p><p><strong>â° Ù…Ø¯Ø© Ø§Ù„ØªÙ†ÙÙŠØ°:</strong> 72 Ø³Ø§Ø¹Ø©</p><p><strong>ğŸ“† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡:</strong> ' + deadline.toLocaleString('ar-SA') + '</p>';
            
            if (wo.notes) {
                html += '<p><strong>ğŸ“ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</strong> ' + wo.notes + '</p>';
            }
            
            html += '<p><strong>ğŸ”” Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ' + (wo.status === 'closed' ? 'âœ“ Ù…ØºÙ„Ù‚' : isExpired ? 'âš ï¸ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„Ù…Ø¯Ø©' : 'â±ï¸ Ù…ÙØªÙˆØ­ - Ù…ØªØ¨Ù‚ÙŠ ' + hoursLeft + ' Ø³Ø§Ø¹Ø©') + '</p>';
            
            if (wo.closedBy) {
                html += '<p><strong>âœ“ ØªÙ… Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø¨ÙˆØ§Ø³Ø·Ø©:</strong> ' + wo.closedBy + ' ÙÙŠ ' + new Date(wo.closedAt).toLocaleString('ar-SA') + '</p>';
            }
            
            html += '</div>';

            if (wo.images && wo.images.length > 0) {
                html += '<h4 class="section-title">ğŸ“¸ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±ÙÙ‚Ø©</h4><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:20px;">';
                wo.images.forEach(img => {
                    html += '<img src="' + img + '" style="width:100%;border-radius:8px;border:3px solid #1e5a3e;">';
                });
                html += '</div>';
            }

            html += '<div class="button-group"><button class="btn btn-secondary" onclick="loadWorkOrders()">â†©ï¸ Ø±Ø¬ÙˆØ¹</button>';
            
            if (wo.status === 'open') {
                html += '<button class="wo-action-btn wo-btn-close" onclick="closeWorkOrder(' + index + ', \'' + supervisorEmail + '\')">âœ“ Ø¥ØºÙ„Ø§Ù‚ Ø£Ù…Ø± Ø§Ù„Ø¹Ù…Ù„</button>';
            }
            
            html += '</div>';

            document.getElementById('workOrdersList').innerHTML = html;
        }

        function closeWorkOrder(index, supervisorEmail) {
            if (!supervisorEmail) {
                alert('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£ÙˆÙ„Ø§Ù‹');
                showPageDirect('settings');
                return;
            }

            const enteredEmail = prompt('ğŸ” Ù„Ù„ØªØ£ÙƒÙŠØ¯ØŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„:');
            
            if (!enteredEmail) {
                return;
            }

            if (enteredEmail.toLowerCase().trim() !== supervisorEmail.toLowerCase().trim()) {
                alert('âŒ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ØºÙŠØ± ØµØ­ÙŠØ­. ÙÙ‚Ø· Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ ÙŠÙ…ÙƒÙ†Ù‡ Ø¥ØºÙ„Ø§Ù‚ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¹Ù…Ù„.');
                return;
            }

            const closedBy = prompt('âœï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ:');
            if (!closedBy) {
                return;
            }

            let workOrders = JSON.parse(localStorage.getItem('moh_workorders') || '[]');
            workOrders[index].status = 'closed';
            workOrders[index].closedAt = new Date().toISOString();
            workOrders[index].closedBy = closedBy;
            
            localStorage.setItem('moh_workorders', JSON.stringify(workOrders));
            
            alert('âœ… ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø£Ù…Ø± Ø§Ù„Ø¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­');
            loadWorkOrders();
        }

        function printReport(index) {
            const reports = JSON.parse(localStorage.getItem('moh_reports') || '[]');
            const r = reports[index];
            
            let printContent = '<!DOCTYPE html><html dir="rtl"><head><meta charset="UTF-8"><title>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ - ' + r.date + '</title><style>body { font-family: Arial; padding: 20px; }h1, h2 { color: #1e5a3e; text-align: center; }table { width: 100%; border-collapse: collapse; margin: 20px 0; }td { padding: 8px; border: 1px solid #ddd; }.item { margin: 10px 0; padding: 10px; border: 1px solid #1e5a3e; }</style></head><body><h1>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h1><h2>ÙØ±Ø¹ ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØµØ­Ø© Ø¨Ø­ÙØ± Ø§Ù„Ø¨Ø§Ø·Ù†</h2><p style="text-align:center;">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø³Ø§Ù†Ø¯Ø© - Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…Ø³Ø§Ù†Ø¯</p><table><tr><td><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong></td><td>' + r.date + '</td></tr><tr><td><strong>Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong></td><td>' + r.locationText + '</td></tr><tr><td><strong>Ø§Ù„Ù‚Ø§Ø¦Ù…ÙˆÙ† Ø¨Ø§Ù„Ø¬ÙˆÙ„Ø©:</strong></td><td>1. ' + r.person1 + '<br>2. ' + r.person2 + '<br>3. ' + r.person3 + '</td></tr></table><h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:</h3>';

            r.items.forEach(item => {
                printContent += '<div class="item"><strong>' + item.number + '. ' + item.title + '</strong><br>Ø§Ù„Ù†ØªÙŠØ¬Ø©: ' + item.result + '<br>' + (item.notes ? 'Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ' + item.notes : '') + '</div>';
            });

            printContent += '</body></html>';

            const printWindow = window.open('', '', 'height=600,width=800');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
        }

        function saveSettings() {
            const contractorEmail = document.getElementById('contractorEmail').value;
            const supervisorEmail = document.getElementById('supervisorEmail').value;

            if (!contractorEmail || !supervisorEmail) {
                alert('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                return;
            }

            localStorage.setItem('moh_defaultPerson1', document.getElementById('defaultPerson1').value);
            localStorage.setItem('moh_defaultPerson2', document.getElementById('defaultPerson2').value);
            localStorage.setItem('moh_defaultPerson3', document.getElementById('defaultPerson3').value);
            localStorage.setItem('moh_contractorEmail', contractorEmail);
            localStorage.setItem('moh_supervisorEmail', supervisorEmail);
            
            alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
            loadSettings();
        }

        function loadSettings() {
            const person1 = localStorage.getItem('moh_defaultPerson1') || '';
            const person2 = localStorage.getItem('moh_defaultPerson2') || '';
            const person3 = localStorage.getItem('moh_defaultPerson3') || '';
            const contractorEmail = localStorage.getItem('moh_contractorEmail') || '';
            const supervisorEmail = localStorage.getItem('moh_supervisorEmail') || '';
            
            document.getElementById('defaultPerson1').value = person1;
            document.getElementById('defaultPerson2').value = person2;
            document.getElementById('defaultPerson3').value = person3;
            document.getElementById('contractorEmail').value = contractorEmail;
            document.getElementById('supervisorEmail').value = supervisorEmail;
            
            document.getElementById('person1').value = person1;
            document.getElementById('person2').value = person2;
            document.getElementById('person3').value = person3;
        }

        function setTodayDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').value = today;
        }
    </script>
</body>
</html>

